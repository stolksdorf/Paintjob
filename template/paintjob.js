!function(){Archetype={initialize:function(){return this},blueprint:function(a){for(var b in a)this[b]=a[b];return this.__blueprint__=this,this},extend:function(a){return Object.create(this).blueprint(a)},"super":function(a){return Object.getPrototypeOf(this.__blueprint__)[a].apply(this,Array.prototype.slice.apply(arguments).slice(1))},on:function(a,b){return this.__events__=this.__events__||{},this.__events__[a]=this.__events__[a]||[],this.__events__[a].push(b),this},trigger:function(a){if(!this.__muted__){if(this.__events__=this.__events__||{},this.__events__[a])for(var b=0;b<this.__events__[a].length;b++)this.__events__[a][b].apply(this,Array.prototype.slice.apply(arguments).slice(1));return this}},mute:function(){return this.__muted__=!0,this},unmute:function(){return this.__muted__=!1,this}},Promise=Object.create(Archetype).blueprint({then:function(a,b){try{}catch(c){"function"==typeof b&&b(c)}return this},and:function(){return this}}),Model=Object.create(Archetype).blueprint({defaults:{},initialize:function(a){return this.reset(a),this},get:function(a){return this.attributes[a]},set:function(a,b){return this.attributes[a]=b,this.trigger("change:"+a),this.trigger("change"),this},has:function(a){return"undefined"!=typeof this.attributes[a]},toJSON:function(){return JSON.stringify(this.attributes)},reset:function(a){this.attributes=this.defaults;for(var b in a)this.attributes[b]=a[b];return this.trigger("reset"),this}}),Collection=Object.create(Archetype).blueprint({model:Model,initialize:function(a){return this.reset(a),this},add:function(a){var b=a;return a instanceof this.model||(b=Object.create(this.model).initialize(a)),this.models.push(b),this.trigger("add",b),this},remove:function(a){a instanceof this.model&&(a=a.get("id"));for(var b=0;b<this.models.length;b++)if(this.models[b].get("id")===a)return this.models.splice(b,1),this.trigger("remove",this.models[b]),this;return this},reset:function(a){this.models=[];for(var b=0;b<a.length;b++)this.add(a[b]);return this.trigger("reset"),this},map:function(a){for(var b=[],c=0;c<this.models.length;c++)b.push(a(this.models[c]));return b},reduce:function(a,b){for(var c=0;c<this.models.length;c++)b=a(this.models[c],b);return b},toJSON:function(){return this.map(function(a){return a.toJSON()})}}),Block=Object.create(Archetype).blueprint({block:"",schematic:"",initialize:function(){return this.dom=this.dom||{},""!==this.block&&(this.dom.block=jQuery('[data-block="'+this.block+'"]'),this.getElements(),this.render()),this},injectInto:function(a){return this.dom=this.dom||{},this.trigger("before:inject",this),this.dom.block=this.getSchematic().appendTo(a),this.getElements().render(),this.trigger("inject",this),this},getSchematic:function(){var a=jQuery('[data-schematic="'+this.schematic+'"]'),b=jQuery("<div>").append(a.clone().removeAttr("data-schematic")).html();return jQuery(b)},getElements:function(){var a=this;return this.dom.block.find("[data-element]").each(function(b,c){c=jQuery(c),a.dom[c.data("element")]=c}),this},render:function(){return this},mapActions:function(a){for(var b in a){var c=b.split(" ")[0],d=b.split(" ")[1];this.dom[c].on(d,a[b])}return this}})}(),CodeMirror.defineMode("javascript",function(a,b){function c(a,b,c){return b.tokenize=c,c(a,b)}function d(a,b){for(var c,d=!1;null!=(c=a.next());){if(c==b&&!d)return!1;d=!d&&"\\"==c}return d}function e(a,b,c){return R=a,S=c,b}function f(a,b){var f=a.next();if('"'==f||"'"==f)return c(a,b,g(f));if(/[\[\]{}\(\),;\:\.]/.test(f))return e(f);if("0"==f&&a.eat(/x/i))return a.eatWhile(/[\da-f]/i),e("number","number");if(/\d/.test(f)||"-"==f&&a.eat(/\d/))return a.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),e("number","number");if("/"==f)return a.eat("*")?c(a,b,h):a.eat("/")?(a.skipToEnd(),e("comment","comment")):"operator"==b.lastType||"keyword c"==b.lastType||/^[\[{}\(,;:]$/.test(b.lastType)?(d(a,"/"),a.eatWhile(/[gimy]/),e("regexp","string-2")):(a.eatWhile(X),e("operator",null,a.current()));if("#"==f)return a.skipToEnd(),e("error","error");if(X.test(f))return a.eatWhile(X),e("operator",null,a.current());a.eatWhile(/[\w\$_]/);var i=a.current(),j=W.propertyIsEnumerable(i)&&W[i];return j&&"."!=b.lastType?e(j.type,j.style,i):e("variable","variable",i)}function g(a){return function(b,c){return d(b,a)||(c.tokenize=f),e("string","string")}}function h(a,b){for(var c,d=!1;c=a.next();){if("/"==c&&d){b.tokenize=f;break}d="*"==c}return e("comment","comment")}function i(a,b,c,d,e,f){this.indented=a,this.column=b,this.type=c,this.prev=e,this.info=f,null!=d&&(this.align=d)}function j(a,b){for(var c=a.localVars;c;c=c.next)if(c.name==b)return!0}function k(a,b,c,d,e){var f=a.cc;for(Z.state=a,Z.stream=e,Z.marked=null,Z.cc=f,a.lexical.hasOwnProperty("align")||(a.lexical.align=!0);;){var g=f.length?f.pop():U?u:t;if(g(c,d)){for(;f.length&&f[f.length-1].lex;)f.pop()();return Z.marked?Z.marked:"variable"==c&&j(a,d)?"variable-2":b}}}function l(){for(var a=arguments.length-1;a>=0;a--)Z.cc.push(arguments[a])}function m(){return l.apply(null,arguments),!0}function n(a){function b(b){for(var c=b;c;c=c.next)if(c.name==a)return!0;return!1}var c=Z.state;if(c.context){if(Z.marked="def",b(c.localVars))return;c.localVars={name:a,next:c.localVars}}else{if(b(c.globalVars))return;c.globalVars={name:a,next:c.globalVars}}}function o(){Z.state.context={prev:Z.state.context,vars:Z.state.localVars},Z.state.localVars=$}function p(){Z.state.localVars=Z.state.context.vars,Z.state.context=Z.state.context.prev}function q(a,b){var c=function(){var c=Z.state;c.lexical=new i(c.indented,Z.stream.column(),a,null,c.lexical,b)};return c.lex=!0,c}function r(){var a=Z.state;a.lexical.prev&&(")"==a.lexical.type&&(a.indented=a.lexical.indented),a.lexical=a.lexical.prev)}function s(a){return function(b){return b==a?m():";"==a?l():m(arguments.callee)}}function t(a){return"var"==a?m(q("vardef"),I,s(";"),r):"keyword a"==a?m(q("form"),u,t,r):"keyword b"==a?m(q("form"),t,r):"{"==a?m(q("}"),F,r):";"==a?m():"if"==a?m(q("form"),u,t,r,K(Z.state.indented)):"function"==a?m(P):"for"==a?m(q("form"),s("("),q(")"),L,s(")"),r,t,r):"variable"==a?m(q("stat"),A):"switch"==a?m(q("form"),u,q("}","switch"),s("{"),F,r,r):"case"==a?m(u,s(":")):"default"==a?m(s(":")):"catch"==a?m(q("form"),o,s("("),Q,s(")"),t,r,p):l(q("stat"),u,s(";"),r)}function u(a){return w(a,y)}function v(a){return w(a,z)}function w(a,b){return Y.hasOwnProperty(a)?m(b):"function"==a?m(P):"keyword c"==a?m(x):"("==a?m(q(")"),x,s(")"),r,b):"operator"==a?m(u):"["==a?m(q("]"),E(v,"]"),r,b):"{"==a?m(q("}"),E(C,"}"),r,b):m()}function x(a){return a.match(/[;\}\)\],]/)?l():l(u)}function y(a,b){return","==a?m(u):z(a,b,y)}function z(a,b,c){return c||(c=z),"operator"==a?/\+\+|--/.test(b)?m(c):"?"==b?m(u,s(":"),u):m(u):";"!=a?"("==a?m(q(")","call"),E(v,")"),r,c):"."==a?m(B,c):"["==a?m(q("]"),u,s("]"),r,c):void 0:void 0}function A(a){return":"==a?m(r,t):l(y,s(";"),r)}function B(a){return"variable"==a?(Z.marked="property",m()):void 0}function C(a,b){if("variable"==a){if(Z.marked="property","get"==b||"set"==b)return m(D)}else("number"==a||"string"==a)&&(Z.marked=a+" property");return Y.hasOwnProperty(a)?m(s(":"),v):void 0}function D(a){return":"==a?m(u):"variable"!=a?m(s(":"),u):(Z.marked="property",m(P))}function E(a,b){function c(d){if(","==d){var e=Z.state.lexical;return"call"==e.info&&(e.pos=(e.pos||0)+1),m(a,c)}return d==b?m():m(s(b))}return function(d){return d==b?m():l(a,c)}}function F(a){return"}"==a?m():l(t,F)}function G(a){return":"==a?m(H):l()}function H(a){return"variable"==a?(Z.marked="variable-3",m()):l()}function I(a,b){return"variable"==a?(n(b),V?m(G,J):m(J)):l()}function J(a,b){return"="==b?m(v,J):","==a?m(I):void 0}function K(a){return function(b,c){return"keyword b"==b&&"else"==c?(Z.state.lexical=new i(a,0,"form",null,Z.state.lexical),m(t,r)):l()}}function L(a){return"var"==a?m(I,s(";"),N):";"==a?m(N):"variable"==a?m(M):l(u,s(";"),N)}function M(a,b){return"in"==b?m(u):m(y,N)}function N(a,b){return";"==a?m(O):"in"==b?m(u):l(u,s(";"),O)}function O(a){")"!=a&&m(u)}function P(a,b){return"variable"==a?(n(b),m(P)):"("==a?m(q(")"),o,E(Q,")"),r,t,p):void 0}function Q(a,b){return"variable"==a?(n(b),V?m(G):m()):void 0}var R,S,T=a.indentUnit,U=b.json,V=b.typescript,W=function(){function a(a){return{type:a,style:"keyword"}}var b=a("keyword a"),c=a("keyword b"),d=a("keyword c"),e=a("operator"),f={type:"atom",style:"atom"},g={"if":a("if"),"while":b,"with":b,"else":c,"do":c,"try":c,"finally":c,"return":d,"break":d,"continue":d,"new":d,"delete":d,"throw":d,"var":a("var"),"const":a("var"),let:a("var"),"function":a("function"),"catch":a("catch"),"for":a("for"),"switch":a("switch"),"case":a("case"),"default":a("default"),"in":e,"typeof":e,"instanceof":e,"true":f,"false":f,"null":f,undefined:f,NaN:f,Infinity:f,"this":a("this")};if(V){var h={type:"variable",style:"variable-3"},i={"interface":a("interface"),"class":a("class"),"extends":a("extends"),constructor:a("constructor"),"public":a("public"),"private":a("private"),"protected":a("protected"),"static":a("static"),"super":a("super"),string:h,number:h,bool:h,any:h};for(var j in i)g[j]=i[j]}return g}(),X=/[+\-*&%=<>!?|~^]/,Y={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,"this":!0},Z={state:null,column:null,marked:null,cc:null},$={name:"this",next:{name:"arguments"}};return r.lex=!0,{startState:function(a){return{tokenize:f,lastType:null,cc:[],lexical:new i((a||0)-T,0,"block",!1),localVars:b.localVars,globalVars:b.globalVars,context:b.localVars&&{vars:b.localVars},indented:0}},token:function(a,b){if(a.sol()&&(b.lexical.hasOwnProperty("align")||(b.lexical.align=!1),b.indented=a.indentation()),b.tokenize!=h&&a.eatSpace())return null;var c=b.tokenize(a,b);return"comment"==R?c:(b.lastType="operator"!=R||"++"!=S&&"--"!=S?R:"incdec",k(b,c,R,S,a))},indent:function(a,c){if(a.tokenize==h)return CodeMirror.Pass;if(a.tokenize!=f)return 0;var d=c&&c.charAt(0),e=a.lexical;"stat"==e.type&&"}"==d&&(e=e.prev);var g=e.type,i=d==g;return null!=b.statementIndent&&(")"==g&&e.prev&&"stat"==e.prev.type&&(e=e.prev),"stat"==e.type)?e.indented+b.statementIndent:"vardef"==g?e.indented+("operator"==a.lastType||","==a.lastType?4:0):"form"==g&&"{"==d?e.indented:"form"==g?e.indented+T:"stat"==g?e.indented+("operator"==a.lastType||","==a.lastType?T:0):"switch"!=e.info||i?e.align?e.column+(i?0:1):e.indented+(i?0:T):e.indented+(/^(?:case|default)\b/.test(c)?T:2*T)},electricChars:":{}",jsonMode:U}}),CodeMirror.defineMIME("text/javascript","javascript"),CodeMirror.defineMIME("text/ecmascript","javascript"),CodeMirror.defineMIME("application/javascript","javascript"),CodeMirror.defineMIME("application/ecmascript","javascript"),CodeMirror.defineMIME("application/json",{name:"javascript",json:!0}),CodeMirror.defineMIME("text/typescript",{name:"javascript",typescript:!0}),CodeMirror.defineMIME("application/typescript",{name:"javascript",typescript:!0});var Markdown;Markdown="object"==typeof exports&&"function"==typeof require?exports:{},function(){function a(a){return a}function b(){return!1}function c(){}function d(){}c.prototype={chain:function(b,c){var d=this[b];if(!d)throw new Error("unknown hook "+b);this[b]=d===a?c:function(){var a=Array.prototype.slice.call(arguments,0);return a[0]=d.apply(null,a),c.apply(null,a)}},set:function(a,b){if(!this[a])throw new Error("unknown hook "+a);this[a]=b},addNoop:function(b){this[b]=a},addFalse:function(a){this[a]=b}},Markdown.HookCollection=c,d.prototype={set:function(a,b){this["s_"+a]=b},get:function(a){return this["s_"+a]}},Markdown.Converter=function(){function a(a){return a=a.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?(?=\s|$)[ \t]*\n?[ \t]*((\n*)["(](.+?)[")][ \t]*)?(?:\n+)/gm,function(a,b,c,d,e,f){return b=b.toLowerCase(),I.set(b,x(c)),e?d:(f&&J.set(b,f.replace(/"/g,"&quot;")),"")})}function b(a){return a=a.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,e),a=a.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,e),a=a.replace(/\n[ ]{0,3}((<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,e),a=a.replace(/\n\n[ ]{0,3}(<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>[ \t]*(?=\n{2,}))/g,e),a=a.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,e)}function e(a,b){var c=b;return c=c.replace(/^\n+/,""),c=c.replace(/\n+$/g,""),c="\n\n~K"+(K.push(c)-1)+"K\n\n"}function f(a,c){a=H.preBlockGamut(a,M),a=n(a);var d="<hr />\n";return a=a.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,d),a=a.replace(/^[ ]{0,2}([ ]?-[ ]?){3,}[ \t]*$/gm,d),a=a.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm,d),a=o(a),a=q(a),a=v(a),a=H.postBlockGamut(a,M),a=b(a),a=w(a,c)}function g(a){return a=H.preSpanGamut(a),a=s(a),a=h(a),a=y(a),a=k(a),a=i(a),a=A(a),a=a.replace(/~P/g,"://"),a=x(a),a=u(a),a=a.replace(/  +\n/g," <br>\n"),a=H.postSpanGamut(a)}function h(a){var b=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>)/gi;return a=a.replace(b,function(a){var b=a.replace(/(.)<\/?code>(?=.)/g,"$1`");return b=F(b,"!"==a.charAt(1)?"\\`*_/":"\\`*_")})}function i(a){return a=a.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,j),a=a.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?((?:\([^)]*\)|[^()\s])*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,j),a=a.replace(/(\[([^\[\]]+)\])()()()()()/g,j)}function j(a,b,c,d,e,f,g,h){void 0==h&&(h="");var i=b,j=c.replace(/:\/\//g,"~P"),k=d.toLowerCase(),m=e,n=h;if(""==m)if(""==k&&(k=j.toLowerCase().replace(/ ?\n/g," ")),m="#"+k,void 0!=I.get(k))m=I.get(k),void 0!=J.get(k)&&(n=J.get(k));else{if(!(i.search(/\(\s*\)$/m)>-1))return i;m=""}m=E(m),m=F(m,"*_");var o='<a href="'+m+'"';return""!=n&&(n=l(n),n=F(n,"*_"),o+=' title="'+n+'"'),o+=">"+j+"</a>"}function k(a){return a=a.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,m),a=a.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,m)}function l(a){return a.replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}function m(a,b,c,d,e,f,g,h){var i=b,j=c,k=d.toLowerCase(),m=e,n=h;if(n||(n=""),""==m){if(""==k&&(k=j.toLowerCase().replace(/ ?\n/g," ")),m="#"+k,void 0==I.get(k))return i;m=I.get(k),void 0!=J.get(k)&&(n=J.get(k))}j=F(l(j),"*_[]()"),m=F(m,"*_");var o='<img src="'+m+'" alt="'+j+'"';return n=l(n),n=F(n,"*_"),o+=' title="'+n+'"',o+=" />"}function n(a){return a=a.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(a,b){return"<h1>"+g(b)+"</h1>\n\n"}),a=a.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(a,b){return"<h2>"+g(b)+"</h2>\n\n"}),a=a.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(a,b,c){var d=b.length;return"<h"+d+">"+g(c)+"</h"+d+">\n\n"})}function o(a,b){a+="~0";var c=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;return L?a=a.replace(c,function(a,c,d){var e=c,f=d.search(/[*+-]/g)>-1?"ul":"ol",g=p(e,f,b);return g=g.replace(/\s+$/,""),g="<"+f+">"+g+"</"+f+">\n"}):(c=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,a=a.replace(c,function(a,b,c,d){var e=b,f=c,g=d.search(/[*+-]/g)>-1?"ul":"ol",h=p(f,g);return h=e+"<"+g+">\n"+h+"</"+g+">\n"})),a=a.replace(/~0/,"")}function p(a,b,c){L++,a=a.replace(/\n{2,}$/,"\n"),a+="~0";var d=N[b],e=new RegExp("(^[ \\t]*)("+d+")[ \\t]+([^\\r]+?(\\n+))(?=(~0|\\1("+d+")[ \\t]+))","gm"),h=!1;return a=a.replace(e,function(a,b,d,e){var i=e,j=/\n\n$/.test(i),k=j||i.search(/\n{2,}/)>-1;return k||h?i=f(C(i),!0):(i=o(C(i),!0),i=i.replace(/\n$/,""),c||(i=g(i))),h=j,"<li>"+i+"</li>\n"}),a=a.replace(/~0/g,""),L--,a}function q(a){return a+="~0",a=a.replace(/(?:\n\n|^\n?)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(a,b,c){var d=b,e=c;return d=t(C(d)),d=D(d),d=d.replace(/^\n+/g,""),d=d.replace(/\n+$/g,""),d="<pre><code>"+d+"\n</code></pre>","\n\n"+d+"\n\n"+e}),a=a.replace(/~0/,"")}function r(a){return a=a.replace(/(^\n+|\n+$)/g,""),"\n\n~K"+(K.push(a)-1)+"K\n\n"}function s(a){return a=a.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(a,b,c,d){var e=d;return e=e.replace(/^([ \t]*)/g,""),e=e.replace(/[ \t]*$/g,""),e=t(e),e=e.replace(/:\/\//g,"~P"),b+"<code>"+e+"</code>"})}function t(a){return a=a.replace(/&/g,"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a=F(a,"*_{}[]\\",!1)}function u(a){return a=a.replace(/([\W_]|^)(\*\*|__)(?=\S)([^\r]*?\S[\*_]*)\2([\W_]|$)/g,"$1<strong>$3</strong>$4"),a=a.replace(/([\W_]|^)(\*|_)(?=\S)([^\r\*_]*?\S)\2([\W_]|$)/g,"$1<em>$3</em>$4")}function v(a){return a=a.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(a,b){var c=b;return c=c.replace(/^[ \t]*>[ \t]?/gm,"~0"),c=c.replace(/~0/g,""),c=c.replace(/^[ \t]+$/gm,""),c=f(c),c=c.replace(/(^|\n)/g,"$1  "),c=c.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(a,b){var c=b;return c=c.replace(/^  /gm,"~0"),c=c.replace(/~0/g,"")}),r("<blockquote>\n"+c+"\n</blockquote>")})}function w(a,b){a=a.replace(/^\n+/g,""),a=a.replace(/\n+$/g,"");for(var c=a.split(/\n{2,}/g),d=[],e=/~K(\d+)K/,f=c.length,h=0;f>h;h++){var i=c[h];e.test(i)?d.push(i):/\S/.test(i)&&(i=g(i),i=i.replace(/^([ \t]*)/g,"<p>"),i+="</p>",d.push(i))}if(!b){f=d.length;for(var h=0;f>h;h++)for(var j=!0;j;)j=!1,d[h]=d[h].replace(/~K(\d+)K/g,function(a,b){return j=!0,K[b]})}return d.join("\n\n")}function x(a){return a=a.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),a=a.replace(/<(?![a-z\/?!]|~D)/gi,"&lt;")}function y(a){return a=a.replace(/\\(\\)/g,G),a=a.replace(/\\([`*_{}\[\]()>#+-.!])/g,G)}function z(a,b,c,d){if(b)return a;if(")"!==d.charAt(d.length-1))return"<"+c+d+">";for(var e=d.match(/[()]/g),f=0,g=0;g<e.length;g++)"("===e[g]?0>=f?f=1:f++:f--;var h="";if(0>f){var i=new RegExp("\\){1,"+-f+"}$");d=d.replace(i,function(a){return h=a,""})}if(h){var j=d.charAt(d.length-1);R.test(j)||(h=j+h,d=d.substr(0,d.length-1))}return"<"+c+d+">"+h}function A(a){a=a.replace(Q,z);var b=function(a,b){return'<a href="'+b+'">'+H.plainLinkText(b)+"</a>"};return a=a.replace(/<((https?|ftp):[^'">\s]+)>/gi,b)}function B(a){return a=a.replace(/~E(\d+)E/g,function(a,b){var c=parseInt(b);return String.fromCharCode(c)})}function C(a){return a=a.replace(/^(\t|[ ]{1,4})/gm,"~0"),a=a.replace(/~0/g,"")}function D(a){if(!/\t/.test(a))return a;var b,c=["    ","   ","  "," "],d=0;return a.replace(/[\n\t]/g,function(a,e){return"\n"===a?(d=e+1,a):(b=(e-d)%4,d=e+1,c[b])})}function E(a){if(!a)return"";var b=a.length;return a.replace(S,function(c,d){return"~D"==c?"%24":":"!=c||d!=b-1&&!/[0-9\/]/.test(a.charAt(d+1))?"%"+c.charCodeAt(0).toString(16):":"})}function F(a,b,c){var d="(["+b.replace(/([\[\]\\])/g,"\\$1")+"])";c&&(d="\\\\"+d);var e=new RegExp(d,"g");return a=a.replace(e,G)}function G(a,b){var c=b.charCodeAt(0);return"~E"+c+"E"}var H=this.hooks=new c;H.addNoop("plainLinkText"),H.addNoop("preConversion"),H.addNoop("postNormalization"),H.addNoop("preBlockGamut"),H.addNoop("postBlockGamut"),H.addNoop("preSpanGamut"),H.addNoop("postSpanGamut"),H.addNoop("postConversion");var I,J,K,L;this.makeHtml=function(c){if(I)throw new Error("Recursive call to converter.makeHtml");return I=new d,J=new d,K=[],L=0,c=H.preConversion(c),c=c.replace(/~/g,"~T"),c=c.replace(/\$/g,"~D"),c=c.replace(/\r\n/g,"\n"),c=c.replace(/\r/g,"\n"),c="\n\n"+c+"\n\n",c=D(c),c=c.replace(/^[ \t]+$/gm,""),c=H.postNormalization(c),c=b(c),c=a(c),c=f(c),c=B(c),c=c.replace(/~D/g,"$$"),c=c.replace(/~T/g,"~"),c=H.postConversion(c),K=J=I=null,c};var M=function(a){return f(a)},N={ol:"\\d+[.]",ul:"[*+-]"},O="[-A-Z0-9+&@#/%?=~_|[\\]()!:,.;]",P="[-A-Z0-9+&@#/%=~_|[\\])]",Q=new RegExp('(="|<)?\\b(https?|ftp)(://'+O+"*"+P+")(?=$|\\W)","gi"),R=new RegExp(P,"i"),S=/(?:["'*()[\]:]|~D)/g}}(),Paintjob_Block_Example=Object.create(Block).blueprint({schematic:"code_block",initialize:function(a,b,c){var d=this;this.id="codeblock"+b,this.projectData=c,this.super("initialize"),this.dom={block:this.getSchematic()};var e=a.text();return a.parent().replaceWith(this.dom.block),this.getElements(),this.editor=CodeMirror(function(a){d.dom.editor[0].parentNode.replaceChild(a,d.dom.editor[0])},{value:e,mode:"javascript",viewportMargin:1/0,lineNumbers:!0,matchBrackets:!0,tabMode:"indent"}),this.render(),this},render:function(){var a=this;return this.projectData.runnable_code_blocks?(this.dom.runButton.click(function(){a.executeCodeBlock()}),this):(this.dom.runButton.hide(),this.dom.outputContainer.hide(),this)},executeCodeBlock:function(){var self=this,codeBlockHtml=jQuery('[data-schematic="code_html"]'),codeBlockHtmlElement=jQuery(jQuery("<div>").append(codeBlockHtml.clone().removeAttr("data-schematic")).html());codeBlockHtmlElement&&""!==codeBlockHtmlElement?(this.dom.output.replaceWith(codeBlockHtmlElement),this.dom.output=codeBlockHtmlElement,this.dom.output.show().attr("id",this.id),this.dom.outputError.hide(),this.dom.outputContainer.show()):this.dom.outputContainer.hide();try{eval('(function(){var example = $("#'+self.id+'");'+self.editor.getValue()+"})();")}catch(e){self.dom.outputContainer.show(),self.dom.output.hide(),self.dom.outputError.html(e.toString()).show()}return this}}),PaintJob_Block_Icon=Object.create(Block).blueprint({schematic:"project_icon",initialize:function(a){return this.iconData=a,this},render:function(){return this.iconData.link&&("function"==typeof this.iconData.link?this.dom.block.attr("href",this.iconData.link()):this.dom.block.attr("href",this.iconData.link)),this.iconData.tooltip&&this.dom.block.attr("data-hint",this.iconData.tooltip),this.iconData.color&&this.dom.block.addClass(this.iconData.color),this.iconData.icon_class&&this.dom.iconElement.addClass(this.iconData.icon_class),this}}),PaintJob_Block_Project=Object.create(Block).blueprint({block:"project",initialize:function(a){return this.projectData=a,this.dom={block:jQuery('[data-block="'+this.block+'"]')},this.getElements(),this.fetchRepoData(),this},fetchRepoData:function(){var a=this;return this.projectData.use_local?($.get("readme.md",function(b){a.projectData.readme=b,a.projectData.name=a.projectData.display_name||a.projectData.repo,a.render()}),this):($.ajax({url:"https://api.github.com/repos/"+this.projectData.user+"/"+this.projectData.repo,type:"GET",error:function(a){console.error(a.responseText),alert("There was an error gathering the repo data\n\n"+a.responseText)},success:function(b){a.projectData.name=b.name,a.projectData.github_url=b.owner.html_url,a.projectData.description=b.description,"undefined"!=typeof a.projectData.readme&&a.render()}}),$.ajax({url:"https://api.github.com/repos/"+this.projectData.user+"/"+this.projectData.repo+"/readme",type:"GET",headers:{Accept:"application/vnd.github.raw"},error:function(a){console.error(a.responseText),alert("There was an error gathering the repo readme\n\n"+a.responseText)},success:function(b){a.projectData.readme=b,"undefined"!=typeof a.projectData.name&&a.render()}}),this)},render:function(){return this.dom.name.html(this.projectData.name),this.dom.description.html(this.projectData.description),this.sideBar=Object.create(PaintJob_Block_Sidebar).initialize(this.projectData),this.buildDocumentation(this.projectData.readme),this.buildCodeBlocks(),this.buildNav(),this.buildIcons(),this.buildExample(),this},buildDocumentation:function(a){var b=(new Markdown.Converter).makeHtml(a);return b=b.replace(/<h1>/g,'</div><div class="docblock"><h1>'),b=b.substring(b.indexOf('<div class="docblock"><h1>')),this.dom.documentation.html(b+"</div>"),this},buildCodeBlocks:function(){var a=this;return this.dom.documentation.find("pre code").each(function(b,c){Object.create(Paintjob_Block_Example).initialize($(c),b,a.projectData)}),this},buildNav:function(){var a=this,b=["teal","orange","green","blue","red","purple","steel","yellow"];return this.dom.documentation.find(".docblock").each(function(c,d){var d=$(d),e=b[c%b.length];d.addClass(e),a.sideBar.addNavItem(d.find("h1").html(),d,e)}),this},buildExample:function(){return exampleHtml=jQuery('[data-schematic="example_html"]').html(),exampleHtml&&""!==exampleHtml&&this.dom.example.html(exampleHtml),"function"==typeof this.projectData.example_initialize&&this.projectData.example_initialize(),this},buildIcons:function(){var a=this;return _.each(this.projectData.icons,function(b){Object.create(PaintJob_Block_Icon).initialize(b).injectInto(a.dom.iconContainer)}),this}}),PaintJob_Block_Sidebar=Object.create(Block).blueprint({block:"sideBar",initialize:function(a){return this.super("initialize"),this.dom.logo.addClass(a.logo_color),this.dom.logoIcon.addClass(a.logo_class),this},render:function(){var a=this;return this.dom.block.sticky(150),this.dom.logo.click(function(){$("body").scrollTo()}),this.dom.logo.mouseover(function(){a.dom.block.hasClass("stuck")&&(a.dom.logoIcon.hide(),a.dom.logoUp.show())}).mouseout(function(){a.dom.logoIcon.show(),a.dom.logoUp.hide()}),this},addNavItem:function(a,b,c){var d=$("<div></div>").appendTo(this.dom.nav);return d.addClass("sideBar__nav__item").addClass(c).html(a).click(function(){b.scrollTo()}),$(window).scroll(function(){b.hasScrolledPast()?d.addClass("scrolled"):d.removeClass("scrolled")}),this}}),jQuery.fn.sticky=function(a){var b=this,c=a||b.offset().top;return jQuery(window).scroll(function(){b.hasScrolledPast()&&b.css({position:"fixed",top:"0px"}).addClass("stuck"),c>b.offset().top&&b.css({position:"absolute",top:c+"px"}).removeClass("stuck")}),b.parent().css("position","relative"),this},jQuery.fn.hasScrolledPast=function(){return this.offset().top<=jQuery(window).scrollTop()},jQuery.fn.scrollTo=function(a){a=a||800,$("html, body").animate({scrollTop:$(this).offset().top},a)},CreatePaintJob=function(a){return Object.create(PaintJob_Block_Project).initialize(a)};